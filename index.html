<script>
async function generateReply() {
  const userText = document.getElementById("userInput").value.trim();
  const responseBox = document.getElementById("aiResponse");
  if (!userText) {
    alert("H√£y vi·∫øt ƒëi·ªÅu g√¨ ƒë√≥ tr∆∞·ªõc khi g·ª≠i.");
    return;
  }
  responseBox.innerText = "üì® ƒêang g·ª≠i th∆∞ cho T√¢mAI...";
  responseBox.style.display = "block";

  try {
    const res = await fetch("/api/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text: userText })
    });
    const data = await res.json();
    responseBox.innerText = data.reply;
  } catch (error) {
    responseBox.innerText = "‚ùå ƒê√£ c√≥ l·ªói x·∫£y ra!";
    console.error(error);
  }
}

async function playAudio() {
  const text = document.getElementById("aiResponse").innerText;
  if (!text) {
    alert("Ch∆∞a c√≥ n·ªôi dung ƒë·ªÉ ƒë·ªçc!");
    return;
  }
  try {
    const res = await fetch(`/api/tts?text=${encodeURIComponent(text)}`);
    const blob = await res.blob();
    const audioUrl = URL.createObjectURL(blob);
    const audio = new Audio(audioUrl);
    audio.play();
  } catch (error) {
    console.error(error);
    alert("Kh√¥ng th·ªÉ ph√°t gi·ªçng ƒë·ªçc.");
  }
}
</script>
</body>
</html>
